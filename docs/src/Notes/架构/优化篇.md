---
updateTime: '2025-12-21 18:26'
tags: 架构
---
## 问题描述
>  随着**用户量**增长 / **数据量**增长，原本流畅的接口可能突然**变得卡顿**，进而导致用户体验下滑、业务转化流失，甚至引发系统雪崩
## 如何定位
- trace
  - skyWalking
  - 云平台(阿里云 ARMS、腾讯云 APM)
  - Arthas
- 监控
  - 普罗米修斯埋点
    - Timer 类型/Counter 类型
- 日志告警
  - 云平台/ELK分析日志
## 问题原因
- 拿不到CPU时间片
- 内存溢出
- GC的STW
- 网络IO耗时
- SQL耗时
- 代码质量
- 缓存命中率
- 连接打满

## 如何解决
- 缓存
  > 引入缓存，需要注意**一致性、bigKey、热key、内存泄漏**等问题
- 异步并行
  > 引入异步(MQ/多线程)需要注意 **消息丢失/并发安全/子线程执行失败 追踪回滚** 等问题
- 拆分
  - 表拆分
    > 垂直/水平分表需要注意 **事务/路由(分布式ID / join / limit / group by / order by)**
  - sql拆分
    > 在内存拼接，需要注意避免FullGC
  - 分页返回
    > 注意深分页、关闭count等
- 压缩
  > 需要注意压缩/解压缩需要**占用CPU**资源
- 池化
  > 需要注意**内存泄漏问题**
- 批处理
- 索引
- 加机器

