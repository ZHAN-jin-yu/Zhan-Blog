---
updateTime: '2025-09-30 17:17'
tags: 前端八股文
---
## var

- 作用域：函数作用域或全局作用域（没有块级作用域）。
- 变量提升：声明被提升，初始化留在原位置；创建阶段初始值为 `undefined`。
- 可重复声明：同一作用域多次 `var` 同名不会报错（再次声明相当于被忽略，后续重新赋值才改变值）。
- 可重新赋值。
- 全局环境中（非 ES Module）用 `var` 声明的变量会成为全局对象属性（浏览器 `window.xxx`）。
- 不受暂时性死区限制，提升后可在声明前读取到 `undefined`。
- 闭包陷阱：循环里用 `var` 共享同一个绑定。  
  ```js
  for (var i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 0); // 3 3 3
  }
  ```

## function （函数声明）

- 提升：函数声明整体提升（包括函数体），可在代码前调用。
- 全局函数声明（脚本模式）会在全局对象上生成同名属性。
- 与 `var` 同名时的覆盖规则：后出现的同名函数声明会覆盖前面的声明；函数声明优先级高于同名 `var` 声明（但后续对该标识符的赋值仍可覆盖）。
- 块级内的函数声明在 ES2015 以后规范化，浏览器非严格模式下可能实现成类似 `var` 语义（要谨慎，生产中避免在块内直接写函数声明，改用函数表达式）。
- 函数表达式 / 箭头函数只提升变量名（若用 `var` / `let` / `const`），不提升函数体：
  ```js
  console.log(fnDec()); // OK
  function fnDec() { return 1; }

  console.log(fnExp);   // undefined
  var fnExp = function () {};

  // console.log(fnArrow); // ReferenceError (TDZ)
  let fnArrow = () => {};
  ```

## let / const

- 作用域：块级作用域（任意 `{}`）。
- 不可重复声明：同一块级作用域内再次声明同名标识符会报错。
- 提升：声明被放入词法环境，但在初始化前处于暂时性死区（TDZ），访问抛 `ReferenceError`。
- 暂时性死区：从作用域开始到执行到声明语句这一段。
- 不会成为全局对象属性（即 `globalThis.x` 不会出现）。
- let：可重新赋值。
- const：必须在声明处初始化；绑定不可重新指向新值；若值是对象/数组，其内部可变：
  ```js
  const obj = { a: 1 };
  obj.a = 2;      // OK
  // obj = {}     // Error
  ```
- for 循环中 `let` 每次迭代都会创建新绑定，解决闭包问题：
  ```js
  for (let i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 0); // 0 1 2
  }
  ```
- typeof 行为：对处于 TDZ 的 `let/const` 变量使用 `typeof` 会抛错（与未声明的 var 不同）。
  ```js
  // console.log(x); // ReferenceError
  let x = 1;
  ```

## 建议使用策略

1. 优先使用 `const`（语义明确，防止意外重新绑定）。
2. 需要重新赋值时使用 `let`。
3. 避免使用 `var`，除非要兼容旧环境或刻意利用其特性。
4. 避免在块级作用域里使用函数声明（用 `const fn = () => {}`）。

## 速览对比

| 特性                 | var | let | const | function(声明) |
|----------------------|-----|-----|-------|----------------|
| 作用域               | 函数/全局 | 块级 | 块级  | 函数/块(注意兼容) |
| 是否提升             | 是（初始化 undefined） | 是（TDZ） | 是（TDZ） | 是（整体） |
| TDZ                  | 否  | 是  | 是    | 否（声明提升后可用） |
| 可重复声明（同作用域）| 是  | 否  | 否    | 冲突时报错/覆盖语义看位置 |
| 是否可重新赋值        | 是  | 是  | 否(绑定) | N/A |
| 全局是否挂到对象      | 是  | 否  | 否    | 是（脚本模式） |
| 典型用途             | 旧代码/特殊兼容 | 需要变化的值 | 常量绑定 | 声明函数接口 |

## 小练习

```js
console.log(a); // undefined (var 提升)
var a = 10;

// console.log(b); // ReferenceError (TDZ)
let b = 20;

// console.log(c); // ReferenceError (TDZ)
const c = 30;

f(); // OK
function f() {}

try {
  console.log(typeof d); // ReferenceError (TDZ for let)
} catch(e) {
  console.log(e.message);
}
let d =
```

